export XDG_CONFIG_HOME="$HOME/.config"
source "$XDG_CONFIG_HOME/zsh/.zshrc"
[[ ! $(command -v mempurge) ]] && export PATH="$PATH:$HOME/bin"

# --- Homebrew environment ---
eval "$(/opt/homebrew/bin/brew shellenv)"

source ~/.config/zsh/functions.zsh
source ~/.config/zsh/variables.zsh
source ~/.config/zsh/aliases.zsh


# --- Get public IP once per session ---
# Create a temp file and fetch IP in the background
tempfile="$(mktemp -t pubip.XXXXXX)"
(curl -sS ifconfig.me >"$tempfile" &)

# Function to read the IP on demand (cached)
ip() {
  [[ -s "$tempfile" ]] && cat "$tempfile" || echo "fetching..."
}

# Wait briefly for the IP fetch and then print it once at top
echo -e "\n🌐 Public IP: $(ip) (cached)
"

# --- Prompt setup ---
setopt PROMPT_SUBST

# Colors
tangerine="%F{#FF3300}"
green="%F{#AABFAA}"
indigo="%F{#5D00FF}"
gray="%F{#EEEEEE}"
green="%F{#AABFAA}"
white="%F{#FFFFFF}"
reset="%f%k%s"

# Dynamic prompt
setopt PROMPT_SUBST; 
export PS1='%~ $(test -f "$tempfile" && cat "$tempfile" 2>/dev/null) [pid:$$] %(?..%F{red}[exit:%?]%f) %(1j.%F{#00D7AF}[jobs:%j]%f.) 
%F{#00FF66}%K{#000000}%S%n%F{#000000}%K{#00FF66}@%M%k%s%f${reset}'

# --- Optional cleanup trap on exit ---
# (Uncomment if you want to remove tempfile when you close shell)
TRAPEXIT() { rm -f "$tempfile"; }


